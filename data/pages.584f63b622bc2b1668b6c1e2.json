{
  "_id": {
    "$oid": "584f63b622bc2b1668b6c1e2"
  },
  "path": "index",
  "content": "<app-location route=\"{{route}}\" use-hash-as-path></app-location>\n<app-route route=\"{{route}}\" pattern=\"/:type/:id\" data=\"{{resourceData}}\" tail=\"{{resourceDataTail}}\"></app-route>\n<iron-ajax id=\"ajaxResource\" auto url=\"/api/{{resourceData.type}}/{{resourceData.id}}\" handle-as=\"json\" last-response=\"{{resourceResponse}}\"></iron-ajax>\n<iron-ajax id=\"ajaxComponents\" auto url=\"/api/components?conditions=%7B%22type%22%3A%7B%22%24not%22%3A%7B%22%24eq%22%3A%22bower%22%7D%7D%7D\" handle-as=\"json\" last-response=\"{{componentsResponse}}\"></iron-ajax>\n<iron-ajax id=\"ajaxPages\" auto url=\"/api/pages\" handle-as=\"json\" last-response=\"{{pagesResponse}}\"></iron-ajax>\n<app-drawer-layout>\n    <app-drawer swipe-open>\n        <div role=\"listbox\" class=\"resource-list\">\n        \t<paper-item>\n\t\t\t\t<paper-item-body>\n        \t\t\t<h3>Components</h3>\n\t\t\t\t</paper-item-body>\n            \t<paper-icon-button icon=\"add-circle-outline\" onclick=\"modalNewComponent.open()\"></paper-icon-button>\n        \t</paper-item>\n            <template is=\"dom-repeat\" items=\"[[componentsResponse.data]]\">\n                <a class=\"paper-item-link\" href=\"[[url('components', item._id)]]\" tabindex=\"-1\">\n                    <paper-item>[[item.name]]</paper-item>\n                </a>\n            </template>\n        \t<paper-item>\n\t\t\t\t<paper-item-body>\n        \t\t\t<h3>Pages</h3>\n\t\t\t\t</paper-item-body>\n            \t<paper-icon-button icon=\"add-circle-outline\" onclick=\"modalNewPage.open()\"></paper-icon-button>\n        \t</paper-item>\n            <template is=\"dom-repeat\" items=\"[[pagesResponse.data]]\">\n                <a class=\"paper-item-link\" href=\"[[url('pages', item._id)]]\" tabindex=\"-1\">\n                    <paper-item>[[item.name]]</paper-item>\n                </a>\n            </template>\n        </div>\n    </app-drawer>\n    <app-drawer id=\"endDrawer\" class=\"resource-info\" align=\"end\" swipe-open>\n        <paper-material elevation=\"0\">\n    \t\t<form is=\"iron-form\" id=\"formResourceInfo\" content-type=\"application/json\" method=\"post\" action=\"/api/{{resourceData.type}}/{{resourceData.id}}\">\n\t            <paper-input name=\"name\" label=\"Name\" value=\"{{resourceResponse.name}}\"></paper-input>\n\t        \t<paper-input name=\"path\" label=\"Path\" value=\"{{resourceResponse.path}}\"></paper-input>\n\t            <paper-button onclick=\"app.drawer.delete(event)\" class=\"danger\">Delete</paper-button>\n\t        \t<paper-button onclick=\"app.drawer.save(event)\">Save</paper-button>\n            </form>\n\n            <iron-ajax id=\"ajaxResourceComponentsNot\" auto url=\"/api/components?conditions={{resourceComponentsNotParam(resourceResponse.components)}}\" handle-as=\"json\" last-response=\"{{resourceComponentsNotResponse}}\"></iron-ajax>\n\t        <div role=\"listbox\" class=\"resource-list\">\n\t        \t<paper-item>\n\t\t\t\t\t<paper-item-body>\n\t        \t\t\t<h3>Install Components</h3>\n\t\t\t\t\t</paper-item-body>\n\t        \t</paper-item>\n\t            <template is=\"dom-repeat\" items=\"[[resourceComponentsNotResponse.data]]\">\n\t            \t<paper-item>\n\t\t\t\t\t\t<paper-item-body>[[item.name]]</paper-item-body>\n            \t\t\t<paper-icon-button icon=\"add-circle-outline\" on-click=\"resourceComponentAdd\"></paper-icon-button>\n\t            \t</paper-item>\n\t            </template>\n\t        </div>\n\t        \n\t        <iron-ajax id=\"ajaxResourceComponents\" auto url=\"/api/components?conditions={{resourceComponentsParam(resourceResponse.components)}}\" handle-as=\"json\" last-response=\"{{resourceComponentsResponse}}\"></iron-ajax>\n\t        <div role=\"listbox\" class=\"resource-list\">\n\t        \t<paper-item>\n\t\t\t\t\t<paper-item-body>\n\t        \t\t\t<h3>Components</h3>\n\t\t\t\t\t</paper-item-body>\n\t        \t</paper-item>\n\t            <template is=\"dom-repeat\" items=\"[[resourceComponentsResponse.data]]\">\n\t            \t<paper-item>\n\t\t\t\t\t\t<paper-item-body>[[item.name]]</paper-item-body>\n            \t\t\t<paper-icon-button icon=\"remove-circle-outline\" on-click=\"resourceComponentRemove\"></paper-icon-button>\n\t            \t</paper-item>\n\t            </template>\n\t        </div>\n        </paper-material>\n    </app-drawer>\n    <app-header fixed>\n        <app-toolbar>\n            <paper-icon-button icon=\"menu\" drawer-toggle></paper-icon-button>\n            <div main-title>Backrest | {{resourceData.type}} | {{ resourceResponse.name }}</div>\n            <paper-tabs selected=\"{{selected}}\">\n                <paper-tab>HTML</paper-tab>\n                <paper-tab>Style</paper-tab>\n                <paper-tab>Script</paper-tab>\n            </paper-tabs>\n            <paper-button onclick=\"app.save(event)\">Save</paper-button>\n            <paper-icon-button icon=\"info\" onclick=\"app.showEndDrawer()\"></paper-icon-button>\n            <paper-icon-button icon=\"settings\" onclick=\"modalSettings.open()\"></paper-icon-button>\n        </app-toolbar>\n    </app-header>\n    <form is=\"iron-form\" id=\"form\" content-type=\"application/json\" method=\"post\" action=\"/api/{{resourceData.type}}/{{resourceData.id}}\">\n        <iron-pages id=\"resourcePages\" selected=\"{{selected}}\">\n            <div class=\"editor-wrapper\">\n                <juicy-ace-editor id=\"content\" theme=\"ace/theme/tomorrow_night_eighties\" mode=\"ace/mode/html\">{{resourceResponse.content}}</juicy-ace-editor>\n            </div>\n            <div class=\"editor-wrapper\">\n                <juicy-ace-editor id=\"style\" theme=\"ace/theme/tomorrow_night_eighties\" mode=\"ace/mode/css\">{{resourceResponse.style}}</juicy-ace-editor>\n            </div>\n            <div class=\"editor-wrapper\">\n                <juicy-ace-editor id=\"script\" theme=\"ace/theme/tomorrow_night_eighties\" mode=\"ace/mode/javascript\">{{resourceResponse.script}}</juicy-ace-editor>\n            </div>\n        </iron-pages>\n    </form>\n</app-drawer-layout>\n\n<paper-dialog id=\"modalSettings\" class=\"dialog-components\" modal>\n    <app-header>\n        <app-toolbar>\n        \t<div main-title>\n        \t\tComponents\n        \t</div>\n            <paper-tabs selected=\"{{modalSettingsTabSelected}}\">\n                <paper-tab>Install</paper-tab>\n                <paper-tab>Installed</paper-tab>\n            </paper-tabs>\n    \t\t<paper-icon-button icon=\"close\" dialog-confirm></paper-icon-button>\n        </app-toolbar>\n    </app-header>\n    <iron-pages selected=\"{{modalSettingsTabSelected}}\">\n\t\t<div role=\"listbox\" class=\"installed-components-list\">\n\t\t\t<iron-ajax auto url=\"https://beta.webcomponents.org/api/search/{{componentSearch}}%20kind:element?limit=6&count\" handle-as=\"json\" last-response=\"{{searchElementsResponse}}\"></iron-ajax>\n        \t<paper-input no-label-float=\"true\" value=\"{{componentSearch}}\" placeholder=\"Search beta.webcomponents.org for components to install\" class=\"search\">\n\t\t\t\t<iron-icon icon=\"search\" prefix></iron-icon>\n        \t</paper-input>\n\t\t\t<template is=\"dom-repeat\" items=\"[[searchElementsResponse.results]]\">\n\t\t\t\t<paper-icon-item>\n\t\t\t\t\t<iron-icon src=\"[[item.avatar_url]]\" item-icon></iron-icon>\n\t\t\t\t\t<paper-item-body two-line>\n\t\t\t\t\t\t<div>[[item.description]]</div>\n\t\t\t\t\t\t<div secondary>[[item.owner]]/[[item.repo]]&nbsp;&nbsp;[[item.version]]</div>\n\t\t\t\t\t</paper-item-body>\n            \t\t<paper-icon-button icon=\"system-update-alt\" on-click=\"installComponent\"></paper-icon-button>\n\t\t\t\t</paper-icon-item>\n\t\t\t</template>\n\t\t</div>\n\t\t<div role=\"listbox\" class=\"installed-components-list\">\n    \t\t<iron-ajax id=\"ajaxInstalledComponents\" auto url=\"/api/components?conditions=%7B%22type%22%3A%22bower%22%7D\" handle-as=\"json\" last-response=\"{{installedComponentsResponse}}\"></iron-ajax>\n\t\t\t<template is=\"dom-repeat\" items=\"[[installedComponentsResponse.data]]\">\n\t\t\t\t<paper-item>\n\t\t\t\t\t<paper-item-body two-line>\n\t\t\t\t\t\t<div>[[item.name]]</div>\n\t\t\t\t\t\t<div secondary>v[[item.package.version]]</div>\n\t\t\t\t\t</paper-item-body>\n            \t\t<!--<paper-icon-button icon=\"system-update-alt\" on-click=\"updateComponent\"></paper-icon-button>-->\n            \t\t<paper-icon-button icon=\"delete-forever\" on-click=\"deleteComponent\"></paper-icon-button>\n\t\t\t\t</paper-item>\n\t\t\t</template>\n\t\t</div>\t\n\t</iron-pages>\n</paper-dialog>\n\n<paper-dialog id=\"modalNewComponent\" class=\"dialog-new-component\" modal>\n    <app-header>\n        <app-toolbar>\n        \t<div main-title>\n        \t\tNew Component\n        \t</div>\n    \t\t<paper-icon-button icon=\"close\" dialog-confirm></paper-icon-button>\n        </app-toolbar>\n    </app-header>\n    <form is=\"iron-form\" id=\"formNewComponent\" content-type=\"application/json\" method=\"post\" action=\"/api/components\">\n        <paper-input name=\"name\" label=\"Name\" autofocus></paper-input>\n\t\t<div class=\"buttons\">\n\t\t\t<paper-button dialog-dismiss>Cancel</paper-button>\n\t\t\t<paper-button onclick=\"formNewComponent.submit()\">Save</paper-button>\n\t\t</div>\n    </form>\n</paper-dialog>\n\n<paper-dialog id=\"modalNewPage\" class=\"dialog-new-page\" modal>\n    <app-header>\n        <app-toolbar>\n        \t<div main-title>\n        \t\tNew Page\n        \t</div>\n    \t\t<paper-icon-button icon=\"close\" dialog-confirm></paper-icon-button>\n        </app-toolbar>\n    </app-header>\n    <form is=\"iron-form\" id=\"formNewPage\" content-type=\"application/json\" method=\"post\" action=\"/api/pages\">\n        <paper-input name=\"name\" label=\"Name\" autofocus></paper-input>\n        <paper-input name=\"path\" label=\"Path\"></paper-input>\n\t\t<div class=\"buttons\">\n\t\t\t<paper-button dialog-dismiss>Cancel</paper-button>\n\t\t\t<paper-button onclick=\"formNewPage.submit()\">Save</paper-button>\n\t\t</div>\n    </form>\n</paper-dialog>\n",
  "components": [
    "584f63ef22bc2b1668b6c1e4",
    "585616bae4241c7d45cbee50",
    "58561c72a3ece97ebaad9eb3",
    "58561d44a3ece97ebaad9eb4",
    "58561f98f29db17f3d47f8d9",
    "5856200bf29db17f3d47f8da",
    "5858b546d872d7874bb29a66",
    "5858b803d872d7874bb29a67",
    "5858b872d872d7874bb29a68",
    "5858bfe9d872d7874bb29a69",
    "5858c02cd872d7874bb29a6a",
    "5858c6efd872d7874bb29a6b",
    "585a1502d872d7874bb29a6c",
    "585a15bfd872d7874bb29a6d",
    "585b4b62f462b7ce160c089a",
    "585b5d49f462b7ce160c089b",
    "585cad99f462b7ce160c089c"
  ],
  "name": "Index",
  "_modified": {
    "$date": "2016-12-29T05:52:46.013Z"
  },
  "_modifiedBy": "anonymous",
  "style": "body {\n    margin: 0;\n    font-family: 'Roboto', 'Noto', sans-serif;\n    background-color: #eee;\n}\n\napp-toolbar {\n    background-color: #2c5986;\n    color: #fff;\n}\n\napp-drawer-layout {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n}\n\napp-drawer {\n    --app-drawer-content-container: {\n        background-color: #fff;\n        overflow: auto;\n    }\n}\n\npaper-button.danger {\n  color: red;\n}\n\n.resource-info {\n\ttext-align: left;\n}\n\n.resource-list paper-item {\n\tmin-height: 24px;\n}\n\n.resource-list paper-item h3 {\n\tmargin: 7px 0;\n}\n\n.paper-item-link {\n    color: #000;\n    text-decoration: none;\n}\n\npaper-dialog {\n\tmin-width: 360px;\n}\n\npaper-dialog app-header {\n\tmargin: 0;\n\tpadding: 0;\n}\n\npaper-dialog.dialog-components {\n\tmin-height: 364px;\n}\n\npaper-dialog.dialog-components iron-pages {\n\tmargin: 0;\n\tpadding: 0;\n}\n\n.editor-wrapper {\n\tbackground-color: #2D2D2D;\n    position: absolute;\n    top: 64px;\n    left: 0;\n    right: 0;\n    bottom: 0;\n}\n\njuicy-ace-editor {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n}\n\npaper-material {\n\tmargin: 8px;\n}\n\npaper-item {\n    font-size: 9pt;\n}\n\n.installed-components-list {\n\tmax-height: 300px;\n    width: 600px;\n    overflow: auto;\n}\n\n.search {\n\tmargin: 8px 16px;\n}",
  "script": "var app = document.querySelector('#app');\nvar form = document.querySelector('#form');\nvar formResourceInfo = document.querySelector('#formResourceInfo');\nvar formNewComponent = document.querySelector('#formNewComponent');\nvar formNewPage = document.querySelector('#formNewPage');\nvar endDrawer = document.querySelector('#endDrawer');\n\napp.selected = 0;\napp.modalSettingsTabSelected = 0;\n\napp.save = function save() {\n    form.submit();\n};\n\napp.url = function url(type, id) {\n    return '#/' + type + '/' + id;\n};\n\napp.showEndDrawer = function showEndDrawer () {\n\tendDrawer.open();\n\tcontent.style.display = 'none';\n\tstyle.style.display = 'none';\n\tscript.style.display = 'none';\n};\n\napp.installComponent = function installComponent (event) {\n\tvar request = new XMLHttpRequest();\n\trequest.open('POST', '/api/components', true);\n\trequest.setRequestHeader('Content-Type', 'application/json');\n\trequest.onreadystatechange = function () {\n\t\tif (request.readyState != 4 || request.status != 201) {\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tconsole.log(request.responseText)\n\t\tajaxInstalledComponents.generateRequest();\n\t};\n\trequest.send(JSON.stringify({\n\t\t'type': 'bower',\n\t\t'name': event.model.item.repo\n\t}));\n};\n\napp.updateComponent = function updateComponent (event) {\n\tconsole.log(event);\n};\n\napp.deleteComponent = function deleteComponent (event) {\n\tvar request = new XMLHttpRequest();\n\trequest.open('DELETE', '/api/components/' + event.model.item._id, true);\n\trequest.setRequestHeader('Content-Type', 'application/json');\n\trequest.onreadystatechange = function () {\n\t\tif (request.readyState != 4 || request.status != 200) {\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tconsole.log(request.responseText)\n\t\tajaxInstalledComponents.generateRequest();\n\t};\n\trequest.send();\n};\n\napp.drawer = {\n\tsave: function (event) {\n\t\tformResourceInfo.submit();\n\t},\n\tdelete: function (event) {\n\t\tvar request = new XMLHttpRequest();\n\t\trequest.open('DELETE', '/api/' + app.resourceData.type + '/' + app.resourceData.id, true);\n\t\trequest.setRequestHeader('Content-Type', 'application/json');\n\t\trequest.onreadystatechange = function () {\n\t\t\tif (request.readyState != 4 || request.status != 200) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t\tswitch (app.resourceData.type) {\n\t\t\t\tcase 'components':\n\t\t\t\t\tajaxComponents.generateRequest();\n\t\t\t\t\tbreak;\n\t\t\t\t\t\n\t\t\t\tcase 'pages':\n\t\t\t\t\tajaxPages.generateRequest();\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\t\n\t\t\tendDrawer.close();\n\t\t};\n\t\trequest.send();\n\t}\n};\n\napp.resourceComponentRemove = function (event) {\n\tvar index = app.resourceResponse.components.indexOf(event.model.item._id);\n\tapp.resourceResponse.components.splice(index, 1);\n\t\n\tvar request = new XMLHttpRequest();\n\trequest.open('PUT', '/api/' + app.resourceData.type + '/' + app.resourceData.id, true);\n\trequest.setRequestHeader('Content-Type', 'application/json');\n\trequest.onreadystatechange = function () {\n\t\tif (request.readyState != 4 || request.status != 200) {\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tajaxResource.generateRequest();\n\t};\n\trequest.send(JSON.stringify({\n\t\t'components': app.resourceResponse.components\n\t}));\n\tconsole.log('removeComponent', event.model.item);\n};\n\napp.resourceComponentAdd =  function (event) {\n\tif (!app.resourceResponse.components) {\n\t\tapp.resourceResponse.components = [];\n\t}\n\t\n\tapp.resourceResponse.components.push(event.model.item._id);\n\t\n\tvar request = new XMLHttpRequest();\n\trequest.open('PUT', '/api/' + app.resourceData.type + '/' + app.resourceData.id, true);\n\trequest.setRequestHeader('Content-Type', 'application/json');\n\trequest.onreadystatechange = function () {\n\t\tif (request.readyState != 4 || request.status != 200) {\n\t\t\treturn;\n\t\t}\n\t\tajaxResource.generateRequest();\n\t};\n\trequest.send(JSON.stringify({\n\t\t'components': app.resourceResponse.components\n\t}));\n\tconsole.log('addComponent', event.model.item);\n};\n\napp.resourceComponentsNotParam = function (item) {\n\treturn encodeURIComponent(JSON.stringify({'_id': {\n\t\t\t'$nin': item || []\n\t\t}\n\t}));\n};\n\napp.resourceComponentsParam = function (item) {\n\treturn encodeURIComponent(JSON.stringify({'_id': {\n\t\t\t'$in': item || []\n\t\t}\n\t}));\n};\n\nform.addEventListener('iron-form-presubmit', function() {\n    this.request.method = 'put';\n    this.request.body.content = content.value;\n    this.request.body.style = style.value;\n    this.request.body.script = script.value;\n});\n\nformResourceInfo.addEventListener('iron-form-presubmit', function() {\n    this.request.method = 'put';\n});\n\nformResourceInfo.addEventListener('iron-form-response', function (event) {\n\tswitch (app.resourceData.type) {\n\t\tcase 'components':\n\t\t\tajaxComponents.generateRequest();\n\t\t\tbreak;\n\t\t\t\n\t\tcase 'pages':\n\t\t\tajaxPages.generateRequest();\n\t\t\tbreak;\n\t}\n});\n\nformNewComponent.addEventListener('iron-form-response', function (event) {\n\tajaxComponents.generateRequest();\n\tmodalNewComponent.close();\n\tformNewComponent.reset();\n\twindow.location.hash = '/components/' + event.detail.response._id;\n});\n\nformNewPage.addEventListener('iron-form-response', function (event) {\n\tajaxPages.generateRequest();\n\tmodalNewPage.close();\n\tformNewPage.reset();\n\twindow.location.hash = '/pages/' + event.detail.response._id;\n});\n\nendDrawer.addEventListener('app-drawer-transitioned', function (event) {\n\tif (!endDrawer.opened) {\n\t\tcontent.style.display = 'flex';\n\t\tstyle.style.display = 'flex';\n\t\tscript.style.display = 'flex';\n\t}\t\n});\n\nresourcePages.addEventListener('iron-select', function () {\n\tvar editors = [content, style, script];\n\teditors[app.selected].editor.focus();\n\teditors[app.selected].editor.scrollToLine();\n\teditors[app.selected].editor.clearSelection();\n});"
}
