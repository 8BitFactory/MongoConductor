{
  "_id": {
    "$oid": "586f1321ca13868a09474501"
  },
  "name": "resource-info",
  "_created": {
    "$date": "2017-01-06T03:46:41.030Z"
  },
  "_modified": {
    "$date": "2017-01-13T04:26:48.879Z"
  },
  "content": "<paper-material elevation=\"0\">\n\t<form is=\"iron-form\" id=\"formResourceInfo\" content-type=\"application/json\" method=\"post\" action=\"/api/{{resourceType}}/{{resourceId}}\" on-iron-form-presubmit=\"onFormResourceInfoPresubmit\" on-iron-form-response=\"onFormResourceInfoResponse\">\n\t\t<paper-input name=\"name\" label=\"Name\" value=\"{{resource.name}}\" autofocus></paper-input>\n\t    <template is=\"dom-if\" if=\"{{isPage}}\">\n\t\t\t<paper-input name=\"path\" label=\"Path\" value=\"{{resource.path}}\"></paper-input>\n\t\t</template>\n\t\t<paper-button on-click=\"save\">Save</paper-button>\n\t\t<paper-button on-click=\"delete\" class=\"danger\">Delete</paper-button>\n\t</form>\n</paper-material>\n\n<iron-ajax id=\"ajaxResourceComponents\" auto url=\"/api/components?fields=name&amp;conditions={{addedComponentsParam(resource.components)}}\" handle-as=\"json\" last-response=\"{{addedComponents}}\"></iron-ajax>\n<div role=\"listbox\" class=\"resource-list\">\n\t<paper-item>\n\t\t<paper-item-body>\n\t\t\t<h3>Imported Components</h3>\n\t\t</paper-item-body>\n\t</paper-item>\n\t<template is=\"dom-repeat\" items=\"[[addedComponents.data]]\">\n\t\t<paper-item>\n\t\t\t<paper-item-body>[[item.name]]</paper-item-body>\n\t\t\t<paper-icon-button icon=\"remove-circle-outline\" on-click=\"removeComponent\"></paper-icon-button>\n\t\t</paper-item>\n\t</template>\n</div>\n\n<iron-ajax id=\"ajaxResourceComponentsNot\" auto url=\"/api/components?fields=name&amp;conditions={{availableComponentsParam(resource.components)}}\" handle-as=\"json\" last-response=\"{{availableComponents}}\"></iron-ajax>\n<div role=\"listbox\" class=\"resource-list\">\n\t<paper-item>\n\t\t<paper-item-body>\n\t\t\t<h3>Available Components</h3>\n\t\t</paper-item-body>\n\t</paper-item>\n\t<template is=\"dom-repeat\" items=\"[[availableComponents.data]]\">\n\t\t<paper-item>\n\t\t\t<paper-item-body>[[item.name]]</paper-item-body>\n\t\t\t<paper-icon-button icon=\"add-circle-outline\" on-click=\"addComponent\"></paper-icon-button>\n\t\t</paper-item>\n\t</template>\n</div>",
  "_modifiedBy": "anonymous",
  "script": "Polymer({\n\tis: 'resource-info',\n\n\t_resourceTypeChanged: function (newValue) {\n\t\tthis.isPage = newValue === 'pages'\n\t},\n\t\n\tsave: function (event) {\n\t\tthis.querySelector('#formResourceInfo').submit();\n\t},\n\t\n\tdelete: function (event) {\n\t\tvar request = new XMLHttpRequest();\n\t\tvar self = this;\n\t\trequest.open('DELETE', '/api/' + this.resourceType + '/' + this.resourceId, true);\n\t\trequest.setRequestHeader('Content-Type', 'application/json');\n\t\trequest.onreadystatechange = function () {\n\t\t\tif (request.readyState != 4 || request.status != 200) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t\tself.dispatchEvent(new CustomEvent('resource-info-deleted'));\n\t\t};\n\t\trequest.send();\n\t},\n\t\n\tremoveComponent: function (event) {\n\t\tvar self = this;\n\t\tvar index = this.resource.components.indexOf(event.model.item._id);\n\t\tthis.resource.components.splice(index, 1);\n\t\t\n\t\tvar request = new XMLHttpRequest();\n\t\trequest.open('PUT', '/api/' + this.resourceType + '/' + this.resourceId, true);\n\t\trequest.setRequestHeader('Content-Type', 'application/json');\n\t\trequest.onreadystatechange = function () {\n\t\t\tif (request.readyState != 4 || request.status != 200) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t\tself.dispatchEvent(new CustomEvent('resource-info-component-removed'));\n\t\t};\n\t\trequest.send(JSON.stringify({\n\t\t\t'components': this.resource.components\n\t\t}));\n\t},\n\n\taddComponent: function (event) {\n\t\tvar self = this;\n\t\tif (!this.resource.components) {\n\t\t\tthis.resource.components = [];\n\t\t}\n\t\t\n\t\tthis.resource.components.push(event.model.item._id);\n\t\t\n\t\tvar request = new XMLHttpRequest();\n\t\trequest.open('PUT', '/api/' + this.resourceType + '/' + this.resourceId, true);\n\t\trequest.setRequestHeader('Content-Type', 'application/json');\n\t\trequest.onreadystatechange = function () {\n\t\t\tif (request.readyState != 4 || request.status != 200) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tself.dispatchEvent(new CustomEvent('resource-info-component-added'));\n\t\t};\n\t\trequest.send(JSON.stringify({\n\t\t\t'components': this.resource.components\n\t\t}));\n\t},\n\t\n\tavailableComponentsParam: function (item) {\n\t\treturn encodeURIComponent(JSON.stringify({'_id': {\n\t\t\t\t'$nin': item || []\n\t\t\t}\n\t\t}));\n\t},\n\n\taddedComponentsParam: function (item) {\n\t\treturn encodeURIComponent(JSON.stringify({'_id': {\n\t\t\t\t'$in': item || []\n\t\t\t}\n\t\t}));\n\t},\n\t\n\tonFormResourceInfoPresubmit: function (event) {\n\t    event.target.request.method = 'put';\n\t},\n\t\n\tonFormResourceInfoResponse: function (event) {\n\t\tthis.dispatchEvent(new CustomEvent('resource-info-saved'));\n\t},\n\t\n\tproperties: {\n\t\tisPage: {\n\t\t\ttype: 'Boolean',\n\t\t\tvalue: false\n\t\t},\n\t\tresource: {\n\t\t\ttype: 'Object'\n\t\t},\n\t\tresourceId: {\n\t\t\ttype: 'String'\n\t\t},\n\t\tresourceType: {\n\t\t\ttype: 'String',\n    \t\tobserver: '_resourceTypeChanged'\n\t\t}\n\t}\n});",
  "components": [
    "5858c6efd872d7874bb29a6b",
    "585616bae4241c7d45cbee50",
    "5858b872d872d7874bb29a68",
    "5858c02cd872d7874bb29a6a",
    "58561d44a3ece97ebaad9eb4",
    "585a15bfd872d7874bb29a6d"
  ],
  "style": "paper-material {\n\tmargin: 16px;\n}\n\n.danger {\n  color: red;\n}\n\npaper-item {\n\tmin-height: 24px;\n    font-size: 9pt;\n}\n\npaper-item h3 {\n\tmargin: 7px 0;\n}\n\npaper-item paper-icon-button {\n\twidth: 20px;\n\theight: 20px;\n\tpadding: 0;\n}"
}
